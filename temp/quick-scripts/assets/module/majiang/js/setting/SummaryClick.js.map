{"version":3,"sources":["SummaryClick.js"],"names":["cc","Class","extends","Component","properties","miao","Label","list","Prefab","endlist","layout","Node","layout2","action","default","win","lose","liuju","bp","bpb","bpp","num","dabaopai","gameend","op","time","close1","close2","goon1","goon2","csNode","type","cs1","SpriteFrame","onLoad","times","weijifen","wanfa","string","Date","hours","getHours","minutes","getMinutes","sprite","getComponent","Sprite","GameBase","gameModel","spriteFrame","width","y","x","getFullYear","getMonth","getDate","daojishi","clearTimeout","t","find","destroy","init","he","active","match","setInterval","node","userInfo","data","console","log","card","baopai","i","length","instantiate","powerCard","children","parent","gddesk_cards","playOvers","setData","user","id","count","unHu","init2","players","dayingjia","paoshou","counts","inx","zhen","onBGClick","event","dispatchEvent","Event","EventCustom","onCloseClick","setDataEnd"],"mappings":"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","file":"SummaryClick.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\module\\majiang\\js\\setting","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        miao: cc.Label,\r\n        list: cc.Prefab,\r\n        endlist: cc.Prefab,\r\n        layout:cc.Node,\r\n        layout2:cc.Node,        \r\n        action:{default :null},\r\n        win:cc.Node,\r\n        lose:cc.Node,\r\n        liuju:cc.Node,\r\n        bp:cc.Prefab,\r\n        bpb:cc.Prefab,\r\n        bpp:cc.Node,\r\n        num: cc.Label,\r\n        dabaopai:cc.Node,\r\n        gameend:cc.Node,\r\n        op:cc.Label,\r\n        time:cc.Label,\r\n\r\n        close1:cc.Node,\r\n        close2:cc.Node,\r\n\r\n        goon1:cc.Node,\r\n        goon2:cc.Node,\r\n        csNode:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        cs1:{\r\n            default:null,\r\n            type:cc.SpriteFrame\r\n        },\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this.times = 60;\r\n        if(cc.weijifen.wanfa){\r\n            this.op.string = cc.weijifen.wanfa;\r\n        }\r\n        var time = new Date();\r\n        var hours = time.getHours();\r\n        var minutes = time.getMinutes();\r\n        if(hours<10){\r\n            hours = '0' + hours;\r\n        }\r\n        if(minutes<10){\r\n            minutes = '0'+ minutes;\r\n        }\r\n        //切换游戏财神图片\r\n        var sprite = this.csNode.getComponent(cc.Sprite);\r\n        if(cc.weijifen.GameBase.gameModel =='wz'){\r\n            sprite.spriteFrame = this.cs1;\r\n            this.csNode.width = this.csNode.width - 40 ;\r\n            this.csNode.y = this.csNode.y - 10 ;\r\n            this.csNode.x = this.csNode.x + 10;\r\n        }\r\n\r\n        this.time.string = '时间：'+time.getFullYear()+'/'+(time.getMonth()+1)+'/'+time.getDate()+'  ' + hours +': ' +minutes;\r\n        \r\n    },\r\n    daojishi: function(){\r\n        this.times =this.times-1;\r\n        if(this.miao){\r\n            this.miao.string = this.times;\r\n            //console.log(this.time);\r\n            if(this.times==0){\r\n                clearTimeout(this.t);  \r\n                cc.find('Canvas/summary').destroy();\r\n            }\r\n        }\r\n    },\r\n    init:function(){\r\n        let he = this;\r\n        this.goon1.active = true;\r\n        this.close1.active =true;\r\n        if(cc.weijifen.match == 'true'){\r\n            this.t = setInterval(function(){he.daojishi()},1000)  ;\r\n        }else{\r\n            this.miao.node.active = false;\r\n        }\r\n        var userInfo = this.data;\r\n        // if(userInfo.gameOver==true){\r\n        //     var a = this.goon1.children[0].getComponent(cc.Label);\r\n        //     a.string = '查看总成绩';\r\n        //     a.fontSize = 30;\r\n        // }\r\n        this.dabaopai.active = true;\r\n        console.log(userInfo);\r\n        let card,baopai;\r\n        if(cc.weijifen.GameBase.gameModel =='wz'){\r\n            if(cc.weijifen.baopai){\r\n                for(var i = 0;i<cc.weijifen.baopai.length; i++){\r\n                    card = cc.instantiate(this.bp);\r\n                    baopai  = card.getComponent('DeskCards');\r\n                    if(cc.weijifen.powerCard!=null){\r\n                        baopai.node.children[1].active = true;\r\n                    }    \r\n                    baopai.init(cc.weijifen.baopai[i],'B',true);\r\n                    card.parent = this.bpp;    \r\n                }\r\n            }else{\r\n                card = cc.instantiate(this.bpb);\r\n                card.parent = this.bpp;\r\n            }\r\n        }\r\n        this.num.string = cc.find('Canvas').getComponent('MajiangDataBind').gddesk_cards;\r\n        if(userInfo.playOvers){\r\n            let win = false;\r\n            let lose = false;\r\n            let liuju;\r\n            for(let i = 0 ; i< userInfo.playOvers.length; i++){\r\n                var list = cc.instantiate(this.list);\r\n                list.getComponent('EndCards').setData(userInfo.playOvers[i]);\r\n                \r\n                list.parent = this.layout;   \r\n                if(userInfo.playOvers[i].win ==false){\r\n                }\r\n                if(userInfo.playOvers[i].user == cc.weijifen.user.id){\r\n                    if(userInfo.playOvers[i].win ==true){\r\n                        this.win.active =true;\r\n                    }else if(userInfo.playOvers[i].count<0){\r\n                        this.lose.active =true;\r\n                    }  \r\n                }\r\n            }\r\n            if(userInfo.unHu == true){\r\n                this.liuju.active =true;\r\n                this.lose.active = false;\r\n            }\r\n        }\r\n        \r\n    },   \r\n    init2: function(){\r\n        \r\n        this.goon2.active = true;\r\n        this.close2.active =true;\r\n        var userInfo = this.data;\r\n        this.gameend.active = true;\r\n        console.log(userInfo);\r\n        if(userInfo.players){\r\n            let win = false;\r\n            let lose = false;\r\n            let liuju;\r\n            let count = 0;\r\n            for(let i = 0 ; i< userInfo.players.length; i++){\r\n                var list = cc.instantiate(this.endlist);\r\n                var dayingjia = this.dayingjia('pointCount',i);\r\n                var paoshou = this.dayingjia('dianCount',i);\r\n                list.getComponent('endUserInfo').setData(userInfo.players[i],dayingjia,paoshou);\r\n                list.parent = this.layout2;   \r\n             }\r\n        }\r\n        \r\n    },\r\n    dayingjia: function(counts,inx){\r\n        let zhen = true;\r\n        let count = this.data.players[inx][counts];\r\n        for(let i = 0;i < this.data.players.length;i++){\r\n            if(count==0||(i!=inx && this.data.players[i][counts] > count)){\r\n                zhen = false;\r\n                break;\r\n            }\r\n        }\r\n        return zhen;\r\n    },\r\n    /**\r\n     * 结算页面上的 背景的 点击事件，主要是用于事件拦截，禁用冒泡\r\n     * @param event\r\n     */\r\n    onBGClick:function(event){\r\n       \r\n       //后期这里加个判定  当 数小于开局设定局数时 发射这个事件  当局数满了 发送游戏结束的事件，并且退出房间。\r\n        this.node.dispatchEvent(new cc.Event.EventCustom('restar', true));\r\n    },\r\n    /**\r\n     * 结算页面上的关闭按钮 的 点击事件 , 关闭按钮 和 继续按钮 功能是一样的，都是继续游戏\r\n     */\r\n    onCloseClick:function(){\r\n\r\n    },\r\n    setData: function(data){\r\n        // 此处的data为返回的值，有事件、玩家的信息。\r\n        this.data = data;\r\n        this.init();\r\n    },\r\n    setDataEnd: function(data){\r\n        \r\n        this.data = data;\r\n        this.init2();\r\n        \r\n    }\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}