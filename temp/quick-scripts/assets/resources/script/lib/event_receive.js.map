{"version":3,"sources":["event_receive.js"],"names":["WJFCommon","require","cc","Class","extends","properties","onLoad","readyGM_receive","node","on","event","context","find","getComponent","current_ready","active","log","self","socket","getSelf","emit","JSON","stringify","restar_receive","getUserData","weijifen","GameBase","gameModel","director","loadScene","sys","localStorage","getItem","bth","match","x","laizi","children","i","length","destroy","reinitGame","removeItem","shouOperationMune","target","parent","click_receive","mjdata","action","moveTo","setting_coin","runAction","initcardwidth","setting_receive","REFUSE","net_receive","mj","duankai","setItem","takecard_receive","audio","playSFX","card","cardValue","takecard_event","userid","user","id","value","card_script","tingting","setTimeout","actionCard","tingAction","stopPropagation","mySelection_receive","father","selectfather","splice","params","sendEvent","console","name","dan_receive","dans","mjOperation","danParam","peng_receive","gang_receive","gangs","gangParam","chi_receive","chis","sortNumber","a","b","sortNum","array","array2","sort","push","guo_receive"],"mappings":"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","file":"event_receive.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\script\\lib","sourcesContent":["var WJFCommon = require(\"WJFCommon\");\r\ncc.Class({\r\n    extends: WJFCommon,\r\n\r\n    properties: {\r\n\r\n    },\r\n                                                    //                receive\r\n    // use this for initialization\r\n    onLoad: function () {\r\n       \r\n    },\r\n    /*\r\n    * 准备\r\n    */\r\n    readyGM_receive: function () {\r\n        this.node.on('readyGM',function(event){ \r\n            //alert();\r\n            var context = cc.find('Canvas').getComponent('MajiangDataBind'); \r\n            context.current_ready.active = true ; //当前玩家准备（手）   \r\n            cc.log(self)\r\n            let socket = self.getSelf().socket();\r\n            //debugger\r\n            // 点击准备，\r\n            socket.emit('readyGame',JSON.stringify({}))\r\n            // debugger\r\n        });\r\n    },\r\n    /*\r\n    * 重新进入\r\n    */\r\n    restar_receive: function () {\r\n        this.node.on('restar',function(event){\r\n            if(event.getUserData()){                \r\n                if(cc.weijifen.GameBase.gameModel=='wz'){\r\n                    cc.director.loadScene('温州');\r\n                }else{\r\n                    cc.director.loadScene('gameMain');                    \r\n                }\r\n            }else{\r\n                if(cc.sys.localStorage.getItem('clear') != 'true'){\r\n                    var context = cc.find('Canvas').getComponent('MajiangDataBind'); \r\n                    var bth = cc.find('Canvas/global/main/button/readybtn');\r\n                    if(cc.weijifen.match != 'true'){\r\n                        bth.active =true;  \r\n                        bth.x= -10;\r\n                    }\r\n                    var laizi = cc.find('Canvas/global/main/godcard/child').children\r\n                    if(laizi){\r\n                        for(let i =0 ; i < laizi.length ; i ++ ){\r\n                            cc.find('Canvas/global/main/godcard/child').children[i].destroy();\r\n                        }\r\n                    }     \r\n                    context.reinitGame(context);\r\n                }\r\n                cc.sys.localStorage.removeItem('clear');\r\n                self.getSelf().shouOperationMune();\r\n                event.target.parent.destroy(); \r\n            }        \r\n        });\r\n    },\r\n    /*\r\n    * 双击出牌\r\n    */\r\n    click_receive: function () {\r\n        this.node.on('click',function(event){\r\n            let mjdata = cc.find('Canvas').getComponent('MajiangDataBind');\r\n            var action = cc.moveTo(0.5,880,274);\r\n            mjdata.setting_coin.runAction(action);\r\n            mjdata.initcardwidth();\r\n        });\r\n    },\r\n    /*\r\n    * 设置\r\n    */\r\n    setting_receive: function () {\r\n        this.node.on('leaveGame',function(){\r\n            let socket = self.getSelf().socket();\r\n            socket.emit('leaveGame',JSON.stringify({\r\n            }))\r\n        });\r\n        this.node.on('overGame',function(event){\r\n            cc.log('ecent_getUserData',event.getUserData)\r\n            let socket = self.getSelf().socket();\r\n            if(event.getUserData()){\r\n                socket.emit('overGame',JSON.stringify({\r\n                    REFUSE : event.getUserData()\r\n                }))\r\n            }else{\r\n                socket.emit('overGame',JSON.stringify({\r\n                }))\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * 网络断开、重连\r\n    */\r\n    net_receive: function () {\r\n        this.node.on('duankai',function(event){\r\n            let mj = cc.find('Canvas').getComponent('MajiangDataBind');\r\n            mj.duankai.active = true;    \r\n            cc.sys.localStorage.setItem('duankai','true');\r\n        });\r\n       \r\n        this.node.on('chonglian',function(event){\r\n            let mj = cc.find('Canvas').getComponent('MajiangDataBind');\r\n            mj.duankai.active = false;  \r\n            cc.director.loadScene('majiang');\r\n        });\r\n    },\r\n    /*\r\n    * 拿牌\r\n    */\r\n    takecard_receive: function () {\r\n        this.node.on('takecard', function (event) {\r\n            var context = cc.find('Canvas').getComponent('MajiangDataBind');             \r\n            cc.weijifen.audio.playSFX('select.mp3');                            \r\n            if(cc.sys.localStorage.getItem('take') == 'true'){\r\n                let card = event.target.getComponent(\"TakeMJCard\");\r\n                if(card != null){\r\n                    // 手牌\r\n                    let cardValue = card.target.getComponent('HandCards');\r\n                    self.getSelf().takecard_event({userid:cc.weijifen.user.id,card:cardValue.value},self);\r\n                    let card_script = card.target.getComponent(\"HandCards\") ;\r\n                    /**\r\n                     * 提交数据，等待服务器返回\r\n                     */\r\n    \r\n                    let socket = self.getSelf().socket();\r\n                    \r\n                    if (cc.sys.localStorage.getItem('ting') == 'true') {  \r\n                        context.tingting.active = true ;\r\n                        setTimeout(function(){context.tingting.active = false},2000);\r\n                        cc.weijifen.audio.playSFX('nv/ting.mp3');                                \r\n                        let socket = self.getSelf().socket();\r\n                        cc.sys.localStorage.removeItem('ting') ;\r\n                        socket.emit(\"selectaction\" , JSON.stringify({\r\n                            action:\"ting\",\r\n                            actionCard:[card_script.value]\r\n                        }));\r\n                        self.getSelf().tingAction();    \r\n                    } else {\r\n                        // 出牌事件---出的那张牌\r\n                        socket.emit(\"doplaycards\" , card_script.value) ;\r\n                    }\r\n                    //cc.find(\"\");\r\n                    self.getSelf().shouOperationMune();\r\n                }\r\n                event.stopPropagation();\r\n            }\r\n        });\r\n    },\r\n    /*\r\n    * 选择动作\r\n    */\r\n    mySelection_receive: function () {\r\n        this.node.on('mjSelection',function(event){\r\n            let father = cc.find('Canvas').getComponent('MajiangDataBind').selectfather;\r\n            father.active= false;\r\n            father.children[0].children[1].children.splice(0,father.children[0].children[1].children.length);\r\n            let socket = self.getSelf().socket();\r\n            let params = [];\r\n            let sendEvent;\r\n            console.log(event);\r\n            if ( event.getUserData() ) {\r\n                sendEvent = event.getUserData().name ;\r\n                params = event.getUserData().params ;\r\n            }\r\n            socket.emit(\"selectaction\" , JSON.stringify({\r\n                action:sendEvent,\r\n                actionCard:params\r\n            }));\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * 蛋\r\n    */\r\n    dan_receive: function (event) {\r\n        this.node.on(\"dan\",function(event){\r\n            cc.sys.localStorage.removeItem('guo');            \r\n            var context = cc.find('Canvas').getComponent('MajiangDataBind'); \r\n            if ( context.dans && context.dans.length > 1 ) {\r\n                cc.sys.localStorage.removeItem('take');\r\n                context.mjOperation('dan', context.dans,context);\r\n            } else {\r\n                let socket = self.getSelf().socket();\r\n                let danParam = [];\r\n                if ( context.dans ) {\r\n                    danParam = context.dans[0] ;\r\n                }\r\n                socket.emit(\"selectaction\" , JSON.stringify({\r\n                    action:'dan',\r\n                    actionCard:danParam\r\n                }));\r\n            }\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * 碰\r\n    */\r\n    peng_receive: function (event) {\r\n        this.node.on(\"peng\",function(event){\r\n            cc.sys.localStorage.removeItem('guo');            \r\n            let socket = self.getSelf().socket();\r\n            socket.emit(\"selectaction\" , JSON.stringify({\r\n                action:\"peng\",\r\n                actionCard:[]\r\n            }));\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * 杠\r\n    */\r\n    gang_receive: function (event) {\r\n        this.node.on(\"gang\",function(event){\r\n            cc.sys.localStorage.removeItem('guo');            \r\n            var context = cc.find('Canvas').getComponent('MajiangDataBind'); \r\n            if ( context.gangs && context.gangs.length > 1 ) {\r\n                cc.sys.localStorage.removeItem('take');                \r\n                context.mjOperation('gang', context.gangs,context);\r\n            } else {\r\n                let socket = self.getSelf().socket();\r\n                let gangParam = [];\r\n                if ( context.gangs ) {\r\n                    gangParam = context.gangs[0] ;\r\n                }\r\n                socket.emit(\"selectaction\" , JSON.stringify({\r\n                    action:'gang',\r\n                    actionCard:gangParam\r\n                }));\r\n            }\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * 吃\r\n    */\r\n    chi_receive: function (event) {\r\n        this.node.on(\"chi\",function(event){\r\n            cc.sys.localStorage.removeItem('guo');            \r\n            var context = cc.find('Canvas').getComponent('MajiangDataBind'); \r\n            if ( context.chis && context.chis.length > 1 ) {\r\n                cc.sys.localStorage.removeItem('take');\r\n                let array = [];\r\n                let array2 = [];\r\n                function sortNumber(a,b){return a - b}   \r\n                function sortNum(a,b){return b.id - a.id}              \r\n                for(let i = 0 ;i<context.chis.length;i++){\r\n                    let b = {};\r\n                    context.chis[i].sort(sortNumber);\r\n                    b.id = context.chis[i][0];\r\n                    b.value = context.chis[i];\r\n                    array.push(b);\r\n                }\r\n                array.sort(sortNum);\r\n                for(let i = 0 ; i<array.length;i++){\r\n                    array2.push(array[i].value);\r\n                }\r\n                \r\n\r\n                context.mjOperation('chi',array2,context);\r\n            } else {\r\n                let socket = self.getSelf().socket();\r\n                socket.emit(\"selectaction\" , JSON.stringify({\r\n                    action:'chi',\r\n                    actionCard:context.chis[0]\r\n                }));\r\n            }\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * 过\r\n    */\r\n    guo_receive: function (event) {\r\n        this.node.on(\"hu\",function(event){\r\n            //cc.weijifen.audio.playSFX('nv/hu.mp3');            \r\n            cc.sys.localStorage.removeItem('guo');            \r\n            let socket = self.getSelf().socket();\r\n            socket.emit(\"selectaction\" , JSON.stringify({\r\n                action:\"hu\",\r\n                actionCard:[]\r\n            }));\r\n            //cc.find(\"\");\r\n            self.getSelf().shouOperationMune();\r\n            event.stopPropagation();\r\n        });\r\n    },\r\n    /*\r\n    * \r\n    */\r\n\r\n});\r\n\r\n\r\n"]}