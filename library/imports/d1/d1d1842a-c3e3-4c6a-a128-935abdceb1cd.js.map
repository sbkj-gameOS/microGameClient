{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\module\\majiang\\js\\roomInit/assets\\module\\majiang\\js\\roomInit\\RoomInit.js"],"names":["WJFCommon","require","cc","Class","extends","properties","room_num","default","type","Node","onLoad","statics","joinroom_event","data","context","gameStartInitNode","find","getComponent","console","log","weijifen","playerNum","id","sys","localStorage","getItem","player","playerspool","get","playerscript","inx","tablepos","user","setPosition","parent","root","setItem","top_player","init","Number","playersarray","push","status","active","readybth","ready2","playerarray","i","length","playerinfo","on_off_line","headimg","online","color","Color","desk_cards","string","readyNoActive","right_player","left_player","onClick","event","mjdata","socket","param","token","authorization","playway","orgi","room","waittingForPlayers","node","dispatchEvent","Event","EventCustom","exchange_state"],"mappings":"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","file":"RoomInit.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\module\\majiang\\js\\roomInit","sourcesContent":["let WJFCommon = require(\"WJFCommon\");\r\n// 创建房间之后进入\r\ncc.Class({\r\n    extends: WJFCommon,\r\n    properties: {\r\n         //ljh追加 房号 \r\n        room_num:{\r\n            default:null,\r\n            type: cc.Node\r\n        },\r\n\r\n    },\r\n    onLoad: function () {\r\n        // 建立scoket连接\r\n     \r\n\r\n    },\r\n    statics: {\r\n        /**\r\n         * 新创建牌局，首个玩家加入，进入等待状态，等待其他玩家加入，服务端会推送 players数据\r\n         * @param data\r\n         * @param context\r\n         */\r\n        joinroom_event:function(data , context){\r\n            var gameStartInitNode = cc.find('Canvas/js/GameStartInit').getComponent('GameStartInit');\r\n            //如果是2人的模式  就只加自己和对家\r\n            console.log('------------join------');\r\n            console.log(this);\r\n            context = cc.find('Canvas').getComponent('MJDataBind') ;\r\n            if(cc.weijifen.playerNum == 2){\r\n                if(data.id!=cc.sys.localStorage.getItem('current')&&data.id!=cc.sys.localStorage.getItem('top')){\r\n\r\n                    var player = context.playerspool.get();\r\n                    var playerscript = player.getComponent(\"MaJiangPlayer\");\r\n                    var inx = null , tablepos = \"\";\r\n                    if(data.id == cc.weijifen.user.id){\r\n                        player.setPosition(-596 , -236);\r\n                        player.parent = context.root();\r\n                        tablepos = \"current\" ;\r\n                        cc.sys.localStorage.setItem('current',data.id);\r\n                        cc.sys.localStorage.setItem('count','0')\r\n                        \r\n                    }else{\r\n                        player.parent= context.top_player;\r\n                        tablepos = \"top\" ;\r\n                        cc.sys.localStorage.setItem('top',data.id);\r\n                        player.setPosition(0,0);\r\n                        cc.sys.localStorage.setItem('count','2')\r\n                        \r\n                    }\r\n                    playerscript.init(data , inx , tablepos,Number(cc.sys.localStorage.getItem('count')));\r\n                    context.playersarray.push(player) ;\r\n                    if(data.status == 'READY'){    \r\n                        cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                        if(data.id == cc.weijifen.user.id){\r\n                            context.readybth.active = false ;\r\n                            context.ready2.active = false ;\r\n                        }  \r\n                    }\r\n                    \r\n                }else{\r\n                    var playerarray = context.playersarray;\r\n                    if(playerarray){\r\n                        for(let i =0 ; i< playerarray.length;i++){\r\n                            var playerinfo = playerarray[i].getComponent('MaJiangPlayer');\r\n                            var tablepos = playerinfo.tablepos;      \r\n                            var on_off_line = playerinfo.on_off_line;     \r\n                            var headimg = playerinfo.headimg;\r\n                            if(data.id == playerinfo.data.id) {\r\n                                if(data.status == 'READY'){    \r\n                                    cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                                }\r\n                                if(data.online == false){\r\n                                    on_off_line.active = true;\r\n                                    headimg.color = new cc.Color(42, 25, 25);\r\n                                }else{\r\n                                    on_off_line.active = false;\r\n                                    headimg.color = new cc.Color(255, 255, 255);\r\n                                }\r\n                                if(gameStartInitNode.desk_cards.string!='136'){\r\n                                    context.readyNoActive(context);\r\n                                }\r\n                            }\r\n                                \r\n                        }\r\n                    }\r\n                }\r\n                //如果人满了 要求好友的按钮自动消失\r\n                // if(context.playersarray.length == 2){\r\n                //     context.ready2.active = false;\r\n                //     context.readybth.x = -13;\r\n                // }\r\n            }else if(cc.weijifen.playerNum == 3){\r\n                if(data.id!=cc.sys.localStorage.getItem('current')&&data.id!=cc.sys.localStorage.getItem('right')&&data.id!=cc.sys.localStorage.getItem('top')){\r\n                    var player = context.playerspool.get();\r\n                    var playerscript = player.getComponent(\"MaJiangPlayer\");\r\n                    tablepos = \"\";\r\n                    var inx = cc.sys.localStorage.getItem('count');\r\n                    if(data.id == cc.weijifen.user.id){\r\n                        player.setPosition(-584 , -269);\r\n                        player.parent = context.root();\r\n                        tablepos = \"current\" ;\r\n                        cc.sys.localStorage.setItem('current',data.id);\r\n                        \r\n                    }else{\r\n                        if(inx == 0||inx ==2){\r\n                            player.parent= context.right_player;\r\n                            tablepos = \"right\" ;\r\n                            cc.sys.localStorage.setItem('right',data.id);\r\n                            cc.sys.localStorage.setItem('count','1')\r\n                        }else if(inx == 1){\r\n                            player.parent= context.top_player;\r\n                            tablepos = \"top\" ;\r\n                            cc.sys.localStorage.setItem('top',data.id);\r\n                            cc.sys.localStorage.setItem('count','2')   \r\n                        }\r\n                        player.setPosition(0,0);\r\n                    }\r\n                    playerscript.init(data , context.inx , tablepos,Number(cc.sys.localStorage.getItem('count')));\r\n                    context.playersarray.push(player) ;\r\n                    //这里是用来判定自己重连的时候 如果已经准备了 则准备按钮消失\r\n                    if(data.status == 'READY'){    \r\n                        cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                        if(data.id == cc.weijifen.user.id){\r\n                            context.readybth.active = false ;\r\n                            context.ready2.active = false ;\r\n                        }  \r\n                    }\r\n                }else{\r\n                    var playerarray = context.playersarray;\r\n                    if(playerarray){\r\n                        for(let i =0 ; i< playerarray.length;i++){\r\n                            var playerinfo = playerarray[i].getComponent('MaJiangPlayer');\r\n                            var tablepos = playerinfo.tablepos;      \r\n                            var on_off_line = playerinfo.on_off_line;     \r\n                            var headimg = playerinfo.headimg;\r\n                            if(data.id == playerinfo.data.id) {\r\n                                if(data.status == 'READY'){    \r\n                                    cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                                    if(data.id == cc.weijifen.user.id){\r\n                                        context.readybth.active = false ;\r\n                                        context.ready2.active = false ;\r\n                                    }  \r\n                                }\r\n                                if(data.online == false){\r\n                                    on_off_line.active = true;\r\n                                    headimg.color = new cc.Color(42, 25, 25);\r\n                                }else{\r\n                                    on_off_line.active = false;\r\n                                    headimg.color = new cc.Color(255, 255, 255);\r\n                                }\r\n                                //如果已经过了发牌阶段  则隐藏所有的准备状态\r\n                                if(gameStartInitNode.desk_cards.string !='136'){\r\n                                    context.readyNoActive(context);\r\n                                }\r\n                            }    \r\n                        }\r\n                    }\r\n                }\r\n            \r\n            }else{\r\n                // 这是默认的4人模式 \r\n                // 因为 加入会触发 改变状态也会触发该事件，所以用getitem保存一个数据 如果有了这个数据则 只判断状态的改变  如果没有则表示新玩家加入\r\n                if(data.id!=cc.sys.localStorage.getItem('current')&&data.id!=cc.sys.localStorage.getItem('right')&&data.id!=cc.sys.localStorage.getItem('left')&&data.id!=cc.sys.localStorage.getItem('top')){\r\n                    var player = context.playerspool.get();\r\n                    var playerscript = player.getComponent(\"MaJiangPlayer\");\r\n                    tablepos = \"\";\r\n                    var inx = cc.sys.localStorage.getItem('count');\r\n                    if(data.id == cc.weijifen.user.id){\r\n                        player.setPosition(-584 , -269);\r\n                        player.parent = context.root();\r\n                        tablepos = \"current\" ;\r\n                        cc.sys.localStorage.setItem('current',data.id);\r\n                        \r\n                    }else{\r\n                        if(inx == 0||inx ==3){\r\n                            player.parent= context.right_player;\r\n                            tablepos = \"right\" ;\r\n                            cc.sys.localStorage.setItem('right',data.id);\r\n                            cc.sys.localStorage.setItem('count','1')\r\n                        }else if(inx == 1){\r\n                            player.parent= context.top_player;\r\n                            tablepos = \"top\" ;\r\n                            cc.sys.localStorage.setItem('top',data.id);\r\n                            cc.sys.localStorage.setItem('count','2')   \r\n                        }else if(inx == 2){\r\n                            player.parent= context.left_player;\r\n                            tablepos = \"left\" ;\r\n                            cc.sys.localStorage.setItem('left',data.id);\r\n                            cc.sys.localStorage.setItem('count','3')\r\n                        }\r\n                        player.setPosition(0,0);\r\n                    }\r\n                    playerscript.init(data , context.inx , tablepos,Number(cc.sys.localStorage.getItem('count')));\r\n                    context.playersarray.push(player) ;\r\n                    //这里是用来判定自己重连的时候 如果已经准备了 则准备按钮消失\r\n                    if(data.status == 'READY'){    \r\n                        cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                        if(data.id == cc.weijifen.user.id){\r\n                            context.readybth.active = false ;\r\n                            context.ready2.active = false ;\r\n                        }  \r\n                    }\r\n                }else{\r\n                    var playerarray = context.playersarray;\r\n                    if(playerarray){\r\n                        for(let i =0 ; i< playerarray.length;i++){\r\n                            var playerinfo = playerarray[i].getComponent('MaJiangPlayer');\r\n                            var tablepos = playerinfo.tablepos;      \r\n                            var on_off_line = playerinfo.on_off_line;     \r\n                            var headimg = playerinfo.headimg;\r\n                            if(data.id == playerinfo.data.id) {\r\n                                if(data.status == 'READY'){    \r\n                                    cc.find('Canvas/players/ok_'+tablepos+'').active =true;\r\n                                    if(data.id == cc.weijifen.user.id){\r\n                                        context.readybth.active = false ;\r\n                                        //context.ready2.active = false ;\r\n                                    }  \r\n                                }\r\n                                if(data.online == false){\r\n                                    on_off_line.active = true;\r\n                                    headimg.color = new cc.Color(42, 25, 25);\r\n                                }else{\r\n                                    on_off_line.active = false;\r\n                                    headimg.color = new cc.Color(255, 255, 255);\r\n                                }\r\n                                //如果已经过了发牌阶段  则隐藏所有的准备状态\r\n                                if(gameStartInitNode.desk_cards.string !='136'){\r\n                                    context.readyNoActive(context);\r\n                                }\r\n                            }    \r\n                        }\r\n                    }\r\n                }\r\n                // if(context.playersarray.length == 4){\r\n                //     context.ready2.active = false;\r\n                //     var action = cc.moveTo(0.2,-21,-151);\r\n                //     context.readybth.runAction(action);\r\n                }   \r\n        },\r\n    },\r\n    \r\n    onClick: function (event) {\r\n        //开始匹配\r\n        //cc.sys.localStorage.setItem('already','true');\r\n        let mjdata = cc.find('Canvas').getComponent('MJDataBind');\r\n        // var action = cc.moveTo(0.5,880,274);\r\n        // mjdata.setting_coin.runAction(action);\r\n        // var count = event.target.getComponent('Ready').count;\r\n\r\n        let socket = this.socket();\r\n        var param = {\r\n            token:cc.weijifen.authorization,\r\n            playway:cc.weijifen.playway,\r\n            orgi:cc.weijifen.user.orgi\r\n        } ;\r\n        if ( cc.weijifen.room ) {\r\n            param.room = cc.weijifen.room ;\r\n        }\r\n        // let majiang = this.target.getComponent(\"MJDataBind\");\r\n        this.waittingForPlayers();\r\n        // if(count == 0){\r\n        //     event.target.getComponent('Ready').count=count+1;\r\n        //     socket.emit(\"joinroom\" ,JSON.stringify(param)) ;\r\n        // }else{\r\n            this.node.dispatchEvent(new cc.Event.EventCustom('readyGM', true));       \r\n        // }\r\n    },\r\n    waittingForPlayers:function(){\r\n        let context = cc.find('Canvas').getComponent('MJDataBind');\r\n        context.exchange_state(\"ready\" , context);\r\n    },\r\n});\r\n\r\n\r\n\r\n"]}