{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\module\\majiang\\js\\gameEvent/assets\\module\\majiang\\js\\gameEvent\\GameEvent.js"],"names":["WJFCommon","require","cc","Class","extends","properties","actionnode_two","default","type","Node","actionnode_two_list","action_gang_ming_prefab","Prefab","action_gang_an_prefab","gang_current","dan_topcurrent","dan_leftcurrent","dan_rightcurrent","dan_mycurrent","left_danLoyad","right_danLoyad","top_danLoyad","one_card_panel","onLoad","onClick","event","data","node","dispatchEvent","Event","EventCustom","click","target","active","statics","action_event","context","gameEventNode","find","getComponent","sys","localStorage","setItem","removeItem","gang","peng","chi","hu","guo","dan","ting","chis","i","length","push","card","gangs","dans","tings","deal","inx","children","temp","name","count","x","action","moveTo","action123","selectaction_event","gameStartInit","gameEvent","player","userid","opParent","jiantou","tablepos","exchange_searchlight","weijifen","user","id","getItem","rightpre","instantiate","parent","deskcards_right_panel","toppre","deskcards_top_panel","leftpre","deskcards_left_panel","select_action_searchlight","handCardRemove","otherHandCardRemove","opCards","back","fangwei","sortNumber","a","b","cards","sort","splice","actype","cardModle","deskcardpanel","deskcards_current_panel","destroy","exchange_state","playercards","value","cardpool","put","top_panel","topcards","right_panel","rightcards","left_panel","leftcards","cardOp","findCardForKong","init","isGang","zIndex","cardNode","sortAllChildren","cardNum","string","Number","countactive","cardParent","kong","resNode","kcards","kaction","cardcolors","parseInt","cardtype","j","cardUnit","mjvalue","h","setValue"],"mappings":"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","file":"GameEvent.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\module\\majiang\\js\\gameEvent","sourcesContent":["var WJFCommon = require(\"WJFCommon\");\r\ncc.Class({\r\n    extends: WJFCommon,\r\n\r\n    properties: {\r\n        actionnode_two:{        //动作节点\r\n            default:null ,\r\n            type : cc.Node\r\n        },\r\n        actionnode_two_list:{        //动作节点\r\n            default:null ,\r\n            type : cc.Node\r\n        },\r\n        action_gang_ming_prefab:{\r\n            default:null ,\r\n            type : cc.Prefab\r\n        },\r\n        action_gang_an_prefab:{\r\n            default:null ,\r\n            type : cc.Prefab\r\n        },\r\n        gang_current:{        //动作节点\r\n            default:null ,\r\n            type : cc.Node\r\n        },\r\n        dan_topcurrent:cc.Prefab,\r\n        dan_leftcurrent:cc.Prefab,\r\n        dan_rightcurrent:cc.Prefab,\r\n        dan_mycurrent:cc.Prefab,\r\n        left_danLoyad: cc.Node,\r\n        right_danLoyad: cc.Node,\r\n        top_danLoyad: cc.Node,\r\n        one_card_panel:{\r\n            default:null ,\r\n            type : cc.Node\r\n        },\r\n    },\r\n\r\n    //初始化\r\n    onLoad: function () {\r\n       \r\n    },\r\n    onClick:function(event , data){     \r\n                              \r\n        this.node.dispatchEvent( new cc.Event.EventCustom(data, true) );\r\n    },\r\n    click: function(event){\r\n        event.target.active = false;\r\n    },\r\n    statics: {\r\n        /**\r\n         * 接受服务端的数据，玩家杠碰、吃胡等动作\r\n         * @param data\r\n         * @param context\r\n         */\r\n        action_event:function(data, context){\r\n            var gameEventNode = cc.find('Canvas/js/GameEvent').getComponent('GameEvent');\r\n            context = cc.find('Canvas').getComponent('MJDataBind');     \r\n            cc.sys.localStorage.setItem('altake','true');\r\n            cc.sys.localStorage.removeItem('take');\r\n            \r\n            let gang , peng , chi , hu , guo ,dan,ting;\r\n            if(data.chis){\r\n                context.chis = data.chis;\r\n                for(let i =0; i< data.chis.length; i++){\r\n                    context.chis[i].push(data.card);\r\n                }\r\n            }else{\r\n                context.chis =[];\r\n            }\r\n            context.gangs = data[\"gangs\"]?data[\"gangs\"]:[];\r\n            context.dans = data[\"dans\"]?data[\"dans\"]:[];\r\n            context.tings = data[\"tings\"]?data[\"tings\"]:[];\r\n            if(data.deal == true){  //发牌的动作\r\n                cc.sys.localStorage.setItem('guo','true');\r\n                // let desk_script = context.actionnode_two.getComponent(\"DeskCards\") ;\r\n                // desk_script.init(data.card);\r\n                for(var inx = 0 ; inx < gameEventNode.actionnode_two_list.children.length ; inx++){\r\n                    let temp = gameEventNode.actionnode_two_list.children[inx] ;\r\n                    if(temp.name == \"gang\"){gang = temp ;}\r\n                    if(temp.name == \"dan\"){dan = temp ;}\r\n                    if(temp.name == \"ting\"){ting = temp ;}\r\n                    if(temp.name == \"hu\"){hu = temp ;}\r\n                    if(temp.name == \"guo\"){guo = temp ;}\r\n                    temp.active = false ;\r\n                    \r\n                }\r\n                var count = 0;\r\n                if(data.hu){\r\n                    hu.active = true ;\r\n                    hu.x = - 200 + count * 110 ;\r\n                    count++;\r\n                }\r\n                if(data.gang){\r\n                    gang.active = true ;\r\n                    gang.x = - 200 + count * 110 ;\r\n                    count++;\r\n                }\r\n                if(data.dan){\r\n                    dan.active = true ;\r\n                    dan.x = - 200 + count * 110 ;\r\n                    count++;\r\n                }\r\n                if(data.ting){\r\n                    ting.active = true ;\r\n                    ting.x = - 200 + count * 110 ;\r\n                    count++;\r\n                }\r\n                {\r\n                    guo.active =true;\r\n                    guo.x = - 200 + count * 110 ;\r\n                    count++;\r\n                }\r\n               \r\n                var action = cc.moveTo(0.1,800 - count*285,-100);\r\n                //context.actionnode_two.active = true;\r\n                gameEventNode.actionnode_two.x=(-250 - count*100);\r\n                //context.actionnode_two.runAction(action);\r\n                //context.actionnode_deal.active = true ;\r\n\r\n                context.action123 = \"deal\" ;\r\n            }else{\r\n                for(var inx = 0 ; inx < gameEventNode.actionnode_two_list.children.length ; inx++){\r\n                    let temp = gameEventNode.actionnode_two_list.children[inx] ;\r\n                    if(temp.name == \"gang\"){gang = temp ;}\r\n                    if(temp.name == \"peng\"){peng = temp ;}\r\n                    if(temp.name == \"chi\"){chi = temp ;}\r\n                    if(temp.name == \"hu\"){hu = temp ;}\r\n                    if(temp.name == \"guo\"){guo = temp ;}\r\n                    temp.active = false ;\r\n                }\r\n                var count = 0;\r\n                if(data.hu){\r\n                    hu.active = true ;\r\n                    hu.x = - 400 + count * 110\r\n                    count++;\r\n                }\r\n                if(data.gang){\r\n                    gang.active = true ;\r\n                    gang.x = - 400 + count * 110\r\n                    count++;\r\n                }\r\n                if(data.peng){\r\n                    peng.active = true ;\r\n                    peng.x = - 400 + count * 110\r\n                    count++;\r\n                }\r\n                if(data.chi){\r\n                    chi.active = true ;\r\n                    chi.x = - 400 + count * 110\r\n                    count++;\r\n                }\r\n                if(data.deal == false){\r\n                    guo.active = true ;\r\n                    guo.x = - 400 + count * 110\r\n                    count++;\r\n                }  \r\n                var action = cc.moveTo(0.1,800 - count*285,-100);\r\n                gameEventNode.actionnode_two.x=(-250 - count*100);                \r\n                //context.actionnode_two.runAction(action);\r\n                // let ani = context.actionnode_two.getComponent(cc.Animation);\r\n                // ani.play(\"majiang_action\") ;\r\n                context.action123 = \"two\" ;\r\n            }\r\n        },\r\n        selectaction_event:function(data , context){\r\n            context = cc.find('Canvas').getComponent('MJDataBind');     \r\n            var gameStartInit = require('GameStartInit');\r\n            var gameEvent = require('GameEvent');\r\n            //触发音效\r\n            // cc.weijifen.audio.playSFX('nv/'+data.action+'.mp3');        \r\n            let player = gameStartInit.player(data.userid , context), opParent, count = 0;\r\n            let jiantou;\r\n            if(data.target){\r\n                jiantou = gameStartInit.player(data.target , context).tablepos;\r\n            }\r\n            context.exchange_searchlight(player.tablepos , context);\r\n            /**\r\n             * 杠碰吃，胡都需要将牌从 触发玩家的 桌牌 里 移除，然后放入当前玩家 桌牌列表里，如果是胡牌，则放到 胡牌 列表里，首先\r\n             * 首先，需要找到触发对象，如果触发对象不是 all ， 则 直接找到 对象对应的玩家 桌牌列表，并找到 桌牌里 的最后 的 牌，\r\n             * 然后将此牌 移除即可，如果对象是 all， 则不用做任何处理即可\r\n             */\r\n            if(cc.weijifen.user.id == data.userid){   \r\n                if(cc.sys.localStorage.getItem('cb')!='true'){\r\n                    cc.sys.localStorage.setItem('take','true');             \r\n                    \r\n                }\r\n                /**\r\n                 * 碰，显示碰的动画，\r\n                 * 杠，显示杠的动画，杠分为：明杠，暗杠，弯杠，每种动画效果不同，明杠/暗杠需要扣三家分，弯杠需要扣一家分\r\n                 * 胡，根据玩法不同，推倒胡和血流/血战\r\n                 */\r\n                if(data.target == \"all\") {\r\n                    let rightpre = cc.instantiate(context.action_gang_ming_prefab);\r\n                    rightpre.parent = context.deskcards_right_panel.parent;\r\n                    let toppre = cc.instantiate(context.action_gang_ming_prefab);\r\n                    toppre.parent = context.deskcards_top_panel.parent;\r\n                    let leftpre = cc.instantiate(context.action_gang_ming_prefab);\r\n                    leftpre.parent = context.deskcards_left_panel.parent;\r\n                }else{\r\n                    //碰的特效\r\n                    gameEvent.select_action_searchlight(data, context , player) ;\r\n                }\r\n                gameEvent.handCardRemove(data,context);//碰、点杠等情况只有data.card的情况需要处理。\r\n            }\r\n\r\n            opParent = cc.find(\"Canvas/cards/handcards/\"+player.tablepos+\"/kongcards\") ;\r\n            gameEvent.otherHandCardRemove(data,context,player.tablepos);\r\n            let opCards , back = false , fangwei = player.tablepos ;\r\n            if(data.action =='chi'){\r\n                function sortNumber(a,b){return a - b}\r\n                data.cards.sort(sortNumber);\r\n                data.cards.splice(1,0,data.card);                \r\n                opCards = data.cards;\r\n            }else if(data.action == 'peng'){\r\n                data.cards.push(data.card); \r\n                opCards = data.cards;\r\n            }else if(data.action == 'gang'){\r\n                if ( data.card && data.card != -1 ) {\r\n                    data.cards.push(data.card);\r\n                }\r\n                if ( data.actype == 'an' ){\r\n                    back = true ;\r\n                }\r\n                opCards = data.cards;\r\n            }else if(data.action == 'dan'){\r\n                opCards = data.cards;\r\n            }\r\n            gameEvent.cardModle(opCards,opParent,back,fangwei,context,data.action,jiantou);\r\n\r\n            if( cc.sys.localStorage.getItem('cb')!='true'&&(data.action == 'peng'||(data.action == 'gang'&&data.card!=-1)||data.action=='chi'||data.action == 'hu')){\r\n                //以下代码是用于找到 杠/碰/吃/胡牌的 目标牌  ， 然后将此牌 从 桌面牌中移除\r\n                let temp = gameStartInit.player(data.target, context), deskcardpanel=null;\r\n                if (temp.tablepos == \"right\") {\r\n                    deskcardpanel = context.deskcards_right_panel;\r\n                } else if (temp.tablepos == \"left\") {\r\n                    deskcardpanel = context.deskcards_left_panel;\r\n                } else if (temp.tablepos == \"top\") {\r\n                    deskcardpanel = context.deskcards_top_panel;\r\n                }else{\r\n                    deskcardpanel = context.deskcards_current_panel;\r\n                }\r\n                if (deskcardpanel.children.length > 0) {\r\n                    deskcardpanel.children[deskcardpanel.children.length - 1].destroy();\r\n                }\r\n            }\r\n        },\r\n        select_action_searchlight:function(data , context , player){\r\n            context.exchange_searchlight(player.tablepos , context);\r\n            /**\r\n             */\r\n            context.exchange_state(\"nextplayer\" , context);\r\n        },\r\n        handCardRemove: function(data,context){\r\n            if ( data.cards ) {\r\n                for(let i =0 ;i< data.cards.length; i++){\r\n                    for(let inx = 0 ; inx < context.playercards.length ; inx++ ){\r\n                        let temp = context.playercards[inx].getComponent(\"HandCards\");\r\n                        if(data.cards[i]== temp.value){\r\n                            context.cardpool.put(context.playercards[inx]) ;\r\n                            context.playercards.splice(inx, 1) ;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ( data.card != -1 ) {\r\n                for(var inx = 0 ; inx < context.playercards.length ; ){\r\n                    let temp = context.playercards[inx].getComponent(\"HandCards\");\r\n                    if(data.card == temp.value){\r\n                        context.cardpool.put(context.playercards[inx]) ;\r\n                        context.playercards.splice(inx, 1) ;\r\n                        break ;\r\n                    }else{\r\n                        inx++ ;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        otherHandCardRemove: function(data,context,tablepos){\r\n            var gameStartInit = cc.find('Canvas/js/GameStartInit').getComponent('GameStartInit');\r\n            for(let i = 0 ; i<data.cards.length; i++){\r\n                if(tablepos =='top'){\r\n                    gameStartInit.top_panel.children[i].destroy();\r\n                    context.topcards.splice(i,1);\r\n                }else if(tablepos =='right'){\r\n                    gameStartInit.right_panel.children[i].destroy();\r\n                    context.rightcards.splice(i,1);\r\n                }else if(tablepos =='left'){\r\n                    gameStartInit.left_panel.children[i].destroy();\r\n                    context.leftcards.splice(i,1);\r\n                }\r\n            }      \r\n        },\r\n        cardModle: function(cards,parent,back,fangwei,context,action,target){\r\n            var gameStartInit = require('GameStartInit');\r\n            var gameEventNode = cc.find('Canvas/js/GameEvent').getComponent('GameEvent');\r\n            if(cards.length == 1){\r\n                var cardOp,card,temp;\r\n                if(fangwei == 'top'){\r\n                    cardOp = gameStartInit.findCardForKong(parent,cards[0],action) ;\r\n                    card = cc.instantiate(gameEventNode.dan_topcurrent);\r\n                    temp = card.getComponent('DanAction');\r\n                }else if(fangwei == 'left'){\r\n                    cardOp = gameStartInit.findCardForKong(parent,cards[0],action) ;\r\n                    card = cc.instantiate(gameEventNode.dan_leftcurrent);\r\n                    temp = card.getComponent('DanAction');\r\n                }else if(fangwei == 'right'){\r\n                    cardOp = gameStartInit.findCardForKong(parent,cards[0],action) ;\r\n                    card = cc.instantiate(gameEventNode.dan_rightcurrent);\r\n                    temp = card.getComponent('DanAction');\r\n                }else{\r\n                    cardOp = gameStartInit.findCardForKong(parent,cards[0],action) ;\r\n                    card = cc.instantiate(gameEventNode.dan_mycurrent);\r\n                    temp = card.getComponent('DanAction');\r\n                } \r\n                temp.init(cards[i],false,fangwei,'1');\r\n                if ( cardOp.isGang ) {\r\n                    card.zIndex=1;\r\n                    card.parent = cardOp.cardNode ;\r\n                    cardOp.cardNode.sortAllChildren();\r\n                } else {\r\n                    var dan = cardOp.cardNode.children[cardOp.cardNum].getComponent('DanAction');\r\n                    dan.count.string = Number(Number(dan.count.string)+1);\r\n                    dan.countactive();\r\n                }\r\n            }else{\r\n                let cardParent = null ;\r\n                if(fangwei == 'top'){\r\n                    cardParent = cc.instantiate(gameEventNode.top_danLoyad);\r\n                }else if(fangwei == 'left'){\r\n                    cardParent = cc.instantiate(gameEventNode.left_danLoyad);\r\n                }else if(fangwei == 'right'){\r\n                    cardParent = cc.instantiate(gameEventNode.right_danLoyad);\r\n                }else{\r\n                    cardParent = cc.instantiate(gameEventNode.one_card_panel) ;\r\n                }\r\n                for(let i = 0 ; i< cards.length;i++){               \r\n                    if(fangwei == 'top'){\r\n                        var card = cc.instantiate(gameEventNode.dan_topcurrent);\r\n                    }else if(fangwei == 'left'){\r\n                        var card = cc.instantiate(gameEventNode.dan_leftcurrent);\r\n                    }else if(fangwei == 'right'){\r\n                        var card = cc.instantiate(gameEventNode.dan_rightcurrent);\r\n                    }else{\r\n                        var card = cc.instantiate(gameEventNode.dan_mycurrent);             \r\n                    }          \r\n                    var temp = card.getComponent('DanAction');\r\n                    if ( i == 2 && back == true ) {\r\n                        temp.init(cards[i],false,fangwei,'1');\r\n                    }else if(action!='dan'&& i == 1&&back != true){\r\n                        temp.init(cards[i],false,fangwei,'1',target);                    \r\n                    }else {\r\n                        temp.init(cards[i],back,fangwei,'1');\r\n                    }\r\n                    if(71<cards[i]&&cards[i]<76&&action!='chi'){                  \r\n                        card.zIndex =9999;\r\n                    }else {\r\n                        card.zIndex =0;\r\n                    }\r\n                    card.parent = cardParent;\r\n                    //马上进行排序如果不这个方法 会在所有方法执行完后再排序。\r\n                    cardParent.sortAllChildren();               \r\n                    //cardParent.sortAllChildren ( )         \r\n                }\r\n                cardParent.getComponent('Kongcards').init(action);\r\n                cardParent.parent = parent ;\r\n            }       \r\n        },\r\n        findCardForKong: function(kong,card,action) {\r\n            var resNode ;\r\n            var isGang ;\r\n            var cardNum;\r\n            //遍历整个kong 的子集  cards、\r\n            for ( let i = 0 ; i < kong.children.length ; i++ ) {\r\n                var cards = kong.children[i] ;\r\n                var kcards = cards.getComponent('Kongcards');\r\n                var kaction = kcards.action;//获取 事件\r\n                var length = kcards.length;    //获取子集长度\r\n                var type =kcards.type; //获取类型  当为dan 事件时用来判定\r\n                \r\n                var cardcolors = parseInt(card/4 ) ;\r\n                var cardtype  = parseInt(cardcolors / 9);\r\n                var dans = cards.children ;\r\n                //当这个牌是妖姬时\r\n                if(cardtype==2&& parseInt((card%36)/4)==0&&cards.children.length>0&&type!='yao'&&action=='dan'&&kaction =='dan'){\r\n                    resNode = cards ;\r\n                    cardNum = 0;\r\n                    isGang = false;\r\n                    break;\r\n                //当这个牌不是妖姬时\r\n                }else{\r\n                    //cards是peng   action 为gang时\r\n                    if(action == 'gang'&&dans.length>0&kaction == 'peng'){\r\n                        for(let j = 0 ; j<dans.length; j++){\r\n                            var cardUnit = dans[j] ;\r\n                            if ((parseInt((card%36)/4 ) == cardUnit.getComponent(\"DanAction\").mjvalue &&parseInt(card / 36)==cardUnit.getComponent(\"DanAction\").cardtype)||(card<0&&parseInt(card/4 )==cardUnit.getComponent(\"DanAction\").cardcolors)){\r\n                                resNode = cards ;\r\n                                cardNum = j;\r\n                                isGang = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                    //当action 为dan\r\n                    }else if(action == kaction&&dans.length>0){\r\n                        isGang = false;\r\n                        //有两种情况  一种长度为4 和长度为3   \r\n                       \r\n                        for(let j = 0 ; j<dans.length; j++){\r\n\r\n                            var cardUnit = dans[j] ; \r\n                            \r\n                            if(dans.length ==3 &&type=='wind'&&parseInt(card/4 )>=-7&&parseInt(card/4 )<=-4){\r\n                                isGang =true;\r\n                                for(let h = 0 ; h< dans.length;h++){\r\n                                    let cardUnit = dans[h]\r\n                                    if ( parseInt(card/4 ) == cardUnit.getComponent(\"DanAction\").cardcolors ){\r\n                                        isGang = false;\r\n                                        resNode = cards;\r\n                                        cardNum = h;\r\n                                        break;              \r\n                                    }\r\n                                        resNode = cards;\r\n                                        cardNum = h; \r\n                                }\r\n                                break;  \r\n                            }else if(card <0&&((type=='wind'&&parseInt(card/4 )>=-7&&parseInt(card/4 )<=-4)||(type =='xi'&&parseInt(card/4 )>=-3&&parseInt(card/4 )<=-1))){\r\n                                if ( parseInt(card/4 ) == parseInt(cardUnit.getComponent(\"DanAction\").value/4) ){   \r\n                                    resNode = cards ;\r\n                                    cardNum = j;\r\n                                    break;\r\n                                }else if(cardUnit.getComponent(\"DanAction\").cardtype == 2 && parseInt((cardUnit.getComponent(\"DanAction\").value%36)/4) == 0){\r\n                                    cardUnit.getComponent(\"DanAction\").setValue(card);\r\n                                    resNode = cards ;\r\n                                    cardNum = j;\r\n                                    break;\r\n                                }\r\n                            }else if(card >0&&((type == 'yao'&&parseInt((card%36)/4 )==0)||(type == 'jiu'&&parseInt((card%36)/4 )==8))){\r\n                                if(parseInt((card%36)/4 ) == parseInt((cardUnit.getComponent(\"DanAction\").value%36)/4 )&&parseInt(cardUnit.getComponent(\"DanAction\").value/36)==parseInt(card/36)){\r\n                                    resNode = cards ;\r\n                                    cardNum = j;\r\n                                    break;\r\n                                }else if(cardUnit.getComponent(\"DanAction\").cardtype == 2 && parseInt((cardUnit.getComponent(\"DanAction\").value%36)/4) == 0){\r\n                                    cardUnit.getComponent(\"DanAction\").setValue(card);\r\n                                    resNode = cards ;\r\n                                    cardNum = j;\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }   \r\n            return {cardNode:resNode,isGang:isGang,cardNum:cardNum} ;\r\n        },\r\n    },\r\n\r\n    //吃\r\n\r\n\r\n\t//碰    \r\n    \r\n\r\n    //杠\r\n\r\n\r\n    //胡\r\n\r\n\r\n    //听\r\n});\r\n"]}